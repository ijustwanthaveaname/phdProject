sumz                   package:metap                   R Documentation

_C_o_m_b_i_n_e _p-_v_a_l_u_e_s _u_s_i_n_g _t_h_e _s_u_m _o_f _z (_S_t_o_u_f_f_e_r'_s) _m_e_t_h_o_d

_D_e_s_c_r_i_p_t_i_o_n:

     Combine p-values using the sum z method

_U_s_a_g_e:

     sumz(p, weights = NULL, data = NULL, subset = NULL, na.action = na.fail)
     ## S3 method for class 'sumz'
     print(x, ...)
     
_A_r_g_u_m_e_n_t_s:

       p: A vector of significance values

 weights: A vector of weights

    data: Optional data frame containing variables

  subset: Optional vector of logicals to specify a subset of the
          p-values

na.action: A function indicating what should happen when data contains
          NAs

       x: An object of class ‘‘sumz’’

     ...: Other arguments to be passed through

_D_e_t_a_i_l_s:

     Defined as

                     sum (w * z(p)) / sqrt(sum (w * w))                 
     
     is a z where k is the number of studies and w are the weights
     (Stouffer et al. 1949). By default the weights are equal. In the
     absence of effect sizes (in which case a method for combining
     effect sizes would be more appropriate anyway) best results are
     believed to be obtained with weights proportional to the square
     root of the sample sizes (Zaykin 2011)

     The values of p_i should be such that 0<p_i<1 and a warning is
     given if that is not true. An error is given if, possibly as a
     result of removing illegal values, fewer than two values remain.
     If the omitted p values had supplied weights a further warning is
     issued.

     The plot method for class ‘‘metap’’ calls ‘plotp’ on the valid
     p-values.

_V_a_l_u_e:

     An object of class ‘‘sumz’’ and ‘‘metap’’, a list with entries

       z: Transformed sum of z values

       p: Associated p-value

  validp: The input vector with illegal values removed

 weights: The weight vector corresponding to ‘validp’

_A_u_t_h_o_r(_s):

     Michael Dewey

_R_e_f_e_r_e_n_c_e_s:

     Becker BJ (1994). “Combining significance levels.” In Cooper H,
     Hedges LV (eds.), _A handbook of research synthesis_, 215-230.
     Russell Sage, New York.

     Rosenthal R (1978). “Combining results of independent studies.”
     _Psychological Bulletin_, *85*, 185-193.

     Stouffer SA, Suchman EA, DeVinney LC, Star SA, Williams RMJ
     (1949). _The American soldier, vol 1: Adjustment during army
     life_. Princeton University Press, Princeton.

     Zaykin DV (2011). “Optimally weighted Z-test is a powerful method
     for combining probabilities in meta-analysis.” _Journal of
     Evolutionary Biology_, *24*, 1836-1841.

_S_e_e _A_l_s_o:

     See also ‘plotp’

_E_x_a_m_p_l_e_s:

     data(teachexpect)
     sumz(teachexpect) # z = 2.435, p = 0.0074, from Becker
     data(beckerp)
     sumz(beckerp) # z = 1.53, NS, from Beckerp
     data(rosenthal)
     sumz(rosenthal$p) # 2.39, p = 0.009
     sumz(p, df, rosenthal) # 3.01, p = 0.0013
     data(validity)
     sumz(validity) # z = 8.191, p = 1.25 * 10^{-16}
     

